---
import { downloadStrapiImage, type HeroSection } from "../lib/strapi";

interface Props {
  heroData: HeroSection | null;
}

const { heroData } = Astro.props;

// Debug: Check what data we received
if (import.meta.env.DEV) {
  console.log(
    "Hero component received heroData:",
    JSON.stringify(heroData, null, 2)
  );
}

// Use Strapi data if available, otherwise use fallback defaults
const heroTitle = heroData?.heroTitle || "Delicious Food, Made Fresh Daily";
const heroSubtitle =
  heroData?.heroSubtitle ||
  "Experience the finest culinary creations. We bring authentic flavors and quality ingredients to every dish we serve.";
const heroImage = heroData?.heroImage;
const primaryCtaText = heroData?.primaryCtaText || "View Menu";
const primaryCtaLink = heroData?.primaryCtaLink || "#menu";
const secondaryCtaText = heroData?.secondaryCtaText || "Order Now";
const secondaryCtaLink = heroData?.secondaryCtaLink || "#contact";

// Download image at build time and get local path
const imageUrl = await downloadStrapiImage(heroImage?.data?.attributes?.url);
const imageAlt = heroImage?.data?.attributes?.alternativeText || heroTitle;
---

<section
  class="relative bg-gradient-to-br from-cream-50 via-orange-50 to-cream-100 py-20 sm:py-32"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
      <div class="text-left">
        <h1
          class="text-5xl sm:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight tracking-tight"
        >
          <span class="text-primary-600">{heroTitle}</span>
        </h1>

        <p class="text-xl text-gray-600 mb-8 leading-relaxed">
          {heroSubtitle}
        </p>

        <div class="flex flex-col sm:flex-row gap-4">
          {
            primaryCtaText && primaryCtaLink && (
              <a
                href={primaryCtaLink}
                class="bg-accent-500 hover:bg-accent-600 text-white px-8 py-4 rounded-full font-semibold text-lg transition-all shadow-lg hover:shadow-xl inline-flex items-center gap-2"
              >
                {primaryCtaText}
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5l7 7-7 7"
                  />
                </svg>
              </a>
            )
          }

          {
            secondaryCtaText && secondaryCtaLink && (
              <a
                href={secondaryCtaLink}
                class="bg-white hover:bg-cream-50 text-primary-600 px-8 py-4 rounded-full font-semibold text-lg border-2 border-primary-500 transition-all hover:border-primary-600 inline-block"
              >
                {secondaryCtaText}
              </a>
            )
          }
        </div>
      </div>

      {
        imageUrl ? (
          <div class="relative">
            <img
              src={imageUrl}
              alt={imageAlt}
              class="w-full h-auto rounded-2xl shadow-2xl"
            />
          </div>
        ) : (
          <div class="relative">
            <img
              src="/placeholders/hero.svg"
              alt={imageAlt}
              class="w-full h-auto rounded-2xl shadow-2xl"
            />
          </div>
        )
      }
    </div>
  </div>
</section>
